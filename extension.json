{
	"name": "Interactive Data Maps",
	"version": "0.13.2",

	"author": [
		"alex4401"
	],
	"url": "https://mediawiki.org/wiki/Extension:DataMaps",
	"descriptionmsg": "datamap-desc",
	"license-name": "GPL-2.0-or-later",
	"type": "parserhook",

	"requires": {
		"MediaWiki": ">= 1.37.0",
		"platform": {
			"php": ">= 7.4"
		}
	},

	"MessagesDirs": {
		"DataMaps": [
			"i18n/core",
			"i18n/createmap",
			"i18n/ve"
		]
	},
	"ExtensionMessagesFiles": {
		"DataMapsMagic": "DataMaps.magic.php"
	},

	"TrackingCategories": [
		"datamap-category-pages-including-maps"
	],

	"namespaces": [
		{
			"id": 2900,
			"constant": "NS_MAP",
			"name": "Map",
			"defaultcontentmodel": "wikitext",
			"subpages": true,
			"conditional": true
		},
		{
			"id": 2901,
			"constant": "NS_MAP_TALK",
			"name": "Map_talk",
			"subpages": true,
			"conditional": true
		}
	],

	"ResourceFileModulePaths": {
		"localBasePath": "resources",
		"remoteExtPath": "DataMaps/resources"
	},

	"ResourceModules": {
		"ext.ark.datamaps.leaflet": {
			"es6": true,
			"packageFiles": [
				"leafletPkg/index.js",
				"vendor/leaflet/leaflet.js",
				"leafletPkg/iconMarker.js",
				"leafletPkg/circleMarker.js",
				"leafletPkg/popup.js"
			],
			"styles": [
				"vendor/leaflet/leaflet.css"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.icons": {
			"class": "ResourceLoaderOOUIIconPackModule",
			"icons": [
				"exitFullscreen",
				"fullScreen",
				"expand",
				"link",
				"search"
			]
		},

		"ext.ark.datamaps.styles": {
			"dependencies": [
				"ext.ark.datamaps.icons"
			],
			"styles": [
				"styles/main.less",
				"styles/legend.less",
				"styles/controls.less",
				"styles/popups.less"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.core": {
			"es6": true,
			"dependencies": [
				"mediawiki.api"
			],
			"packageFiles": [
				"loader/index.js",
				"loader/enums.js",
				"loader/events.js",
				"loader/storage.js",
				"loader/stream.js",
				"loader/layerManager.js",
				"loader/map.js",
				"loader/legend.js",
				"loader/markerLegend.js",
				"loader/popup.js",
				"loader/dismissables.js",
				{
					"name": "loader/settings.json",
					"config": [
						"DataMapsAllowExperimentalFeatures"
					]
				},
				"loader/util.js"
			],
			"messages": [
				"datamap-error-dataload",
				"datamap-legend-tab-locations",
				"datamap-legend-tab-checklist",
				"datamap-toggle-show-all",
				"datamap-toggle-hide-all",
				"datamap-toggle-caves",
				"datamap-layer-control",
				"datamap-layer-surface",
				"datamap-layer-cave",
				"datamap-popup-related-article",
				"datamap-popup-dismissed",
				"datamap-popup-mark-as-dismissed",
				"datamap-popup-marker-link-get",
				"datamap-popup-marker-link-copied",
				"datamap-coordinate-control-text",
				"datamap-control-reset-view",
				"datamap-control-centre-view",
				"datamap-checklist-prelude"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.bootstrap": {
			"es6": true,
			"dependencies": [
				"ext.ark.datamaps.core"
			],
			"packageFiles": [
				"bootstrap/main.js"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.site": {
			"class": "MediaWiki\\Extension\\Ark\\DataMaps\\Rendering\\ResourceLoaderDataMapsSiteModule"
		},

		"ext.ark.datamaps.inlineloader": {
			"es6": true,
			"dependencies": [
				"ext.ark.datamaps.core",
				"ext.ark.datamaps.bootstrap"
			],
			"packageFiles": [
				"inlineLoader/main.js"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.styles.search": {
			"styles": [
				"search/styles.less"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.fuzzysort": {
			"scripts": [
				"vendor/fuzzysort/fuzzysort.min.js"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.ark.datamaps.search": {
			"es6": true,
			"dependencies": [
				"oojs-ui-core",
				"ext.ark.datamaps.core",
				"ext.ark.datamaps.bootstrap",
				"ext.ark.datamaps.leaflet",
				"ext.ark.datamaps.styles.search",
				"ext.ark.datamaps.fuzzysort"
			],
			"packageFiles": [
				"search/main.js",
				"search/indexing.js",
				"search/menu.js",
				"search/option.js",
				"search/util.js"
			],
			"messages": [
				"datamap-control-search",
				"datamap-control-search-toggle-sharing"
			],
			"targets": [ "desktop", "mobile" ]
		},

		"ext.datamaps.ve.icons": {
			"class": "ResourceLoaderOOUIIconPackModule",
			"icons": [
				"code",
				"noWikiText",
				"wikiText",
				"check",
				"close",
				"menu",
				"required",
				"trash"
			]
		},

		"ext.datamaps.ve": {
			"es6": true,
			"dependencies": [
				"ext.ark.datamaps.core",
				"ext.ark.datamaps.leaflet",
				"oojs-ui-toolbars",
				"oojs-ui-windows",
				"ext.datamaps.ve.icons"
			],
			"packageFiles": [
				"ve/main.js",
				"ve/editor.js",
				"ve/editablePopup.js",
				"ve/widgets/markerGroupEditor.js",
				"ve/tools/commit.js",
				"ve/tools/sourceEditor.js",
				"ve/tools/addMarker.js",
				"ve/dialogs/commit.js",
				"ve/dialogs/confirmDelete.js",
				"ve/dialogs/addMarker.js",
				"ve/dialogs/editMarker.js"
			],
			"styles": [
				"ve/css/bars.less",
				"ve/css/toolbar.less",
				"ve/css/groups.less",
				"ve/css/extension.less",
				"ve/css/popup.less"
			],
			"messages": [
				"datamap-ve-beta-notice",
				"datamap-ve-limited-preview-notice",

				"datamap-ve-legend-tab-marker-groups",
				"datamap-ve-group-id",
				"datamap-ve-group-id-cannot-modify",
				"datamap-ve-group-article-link",
				"datamap-ve-group-article-link-subtext",
				"datamap-ve-group-collectible-mode",

				"datamap-ve-legend-tab-marker-layers",

				"datamap-ve-cancel",
				"datamap-ve-tool-delete",
				"datamap-ve-tool-source-editor",
				"datamap-ve-tool-commit",
				"datamap-ve-tool-commit-continue",
				"datamap-ve-tool-commit-edit-summary",
				"datamap-ve-tool-commit-edit-summary-subtext",

				"datamap-ve-tool-add-marker",
				"datamap-ve-tool-add-marker-continue"
			],
			"targets": [ "desktop" ]
		},

		"ext.datamaps.createMap": {
			"es6": true,
			"dependencies": [
				"oojs-ui-core",
				"oojs-ui-widgets",
				"oojs-ui-windows",
				"mediawiki.widgets",
				"ext.datamaps.ve.icons"
			],
			"packageFiles": [
				"createMap/main.js",
				"createMap/creationDialog.js",
				"core/enums.js"
			],
			"styles": [
				"ve/css/collapsibles.less",
				"createMap/css/all.less"
			],
			"messages": [
				"datamap-vec-beta-notice",

				"datamap-ve-cancel",
				"datamap-vec-title",
				"datamap-vec-intro",
				"datamap-vec-select-crs-origin",
				"datamap-vec-crs-top-left",
				"datamap-vec-crs-bottom-left",
				"datamap-vec-select-crs",
				"datamap-vec-crs-percent",
				"datamap-vec-crs-image",
				"datamap-vec-crs-custom",
				"datamap-vec-select-background",
				"datamap-vec-note-image-size",
				"datamap-vec-error-bad-file-type",
				"datamap-vec-error-poor-file-type",
				"datamap-vec-extra-options",
				"datamap-vec-toggle-coord-display",
				"datamap-vec-toggle-zoom",
				"datamap-vec-toggle-search",
				"datamap-vec-toggle-search-tabber",
				"datamap-vec-toggle-uid-requirement",
				"datamap-vec-submit"
			],
			"targets": [ "desktop" ]
		},

		"ext.datamaps.createMapLazy": {
			"es6": true,
			"packageFiles": [
				"createMapLazy/main.js"
			],
			"targets": [ "desktop" ]
		}
	},

	"AutoloadNamespaces": {
		"MediaWiki\\Extension\\Ark\\DataMaps\\": "includes/"
	},

	"APIModules": {
		"queryDataMap": "MediaWiki\\Extension\\Ark\\DataMaps\\API\\ApiQueryDataMapEndpoint"
	},
	"ContentHandlers": {
		"datamap": "MediaWiki\\Extension\\Ark\\DataMaps\\Content\\DataMapContentHandler"
	},
	
	"callback": "MediaWiki\\Extension\\Ark\\DataMaps\\HookHandler::onRegistration",
	"Hooks": {
		"ParserFirstCallInit": "MainHandler",
		"ContentHandlerDefaultModelFor": "MainHandler",
		"CanonicalNamespaces": "MainHandler",
		"GetPreferences": "MainHandler",
		"SkinTemplateNavigation::Universal": "MainHandler",
		"CustomEditor": "MainHandler",
		"ParserOptionsRegister": "MainHandler",
		"ChangeTagsListActive": "MainHandler",
		"ListDefinedTags": "MainHandler",
		"RecentChange_save": "MainHandler",
		"CodeEditorGetPageLanguage": "MediaWiki\\Extension\\Ark\\DataMaps\\HookHandler::onCodeEditorGetPageLanguage"
	},
    "HookHandlers": {
        "MainHandler": {
            "class": "MediaWiki\\Extension\\Ark\\DataMaps\\HookHandler"
        }
    },

	"DefaultUserOptions": {
		"datamaps-enable-visual-editor": true,
		"datamaps-opt-in-visual-editor-beta": false
	},

	"config_prefix": "wgDataMaps",
	"config": {
		"NamespaceId": {
			"description": "Namespace where data maps will be stored. Use 'managed' to use the built-in namespace.",
			"value": "managed"
		},
		"CacheType": {
			"description": "Cache type to use for queryDataMap API output. Defaults to CACHE_ANYTHING.",
			"value": -1
		},
		"CacheTTL": {
			"description": "Time To Live for cached queryDataMap API (per title and revision) responses to be valid. Set to 0 to disable caching. Defaults to a day.",
			"value": 86400
		},
		"ExtendCacheTTL": {
			"description": "Settings to extend TTL of cached maps on requests close to expiry time. Set to false to disable.",
			"value": {
				"threshold": 43200,
				"override": 57600
			}
		},
		"DefaultApiMarkerBatch": {
			"value": 2500
		},
		"MaxApiMarkerBatch": {
			"value": 5000
		},
		"MarkerParserExpansionLimit": {
			"description": "Controls how big the parser output for a marker's description can get.",
			"value": 800
		},
		"UseInProcessParserCache": {
			"description": "If enabled, uses a simple wikitext parser cache inside the process handling the request.",
			"value": true
		},
		"ReportTimingInfo": {
			"description": "Attaches data map marker processing time in API requests.",
			"value": false
		},
		"DefaultFeatures": {
			"value": {
				"ShowCoordinates": true,
				"ShowLegendAlwaysAbove": false,
				"RequireCustomMarkerIDs": false,
				"Search": false,
				"SortChecklistsByAmount": false
			}
		},
		"EnableVisualEditor": {
			"value": true
		},
		"EnableCreateMap": {
			"value": true
		},
		"AllowExperimentalFeatures": {
			"description": "Whether to enable experimental features.",
			"value": false
		}
	},

	"manifest_version": 2
}
